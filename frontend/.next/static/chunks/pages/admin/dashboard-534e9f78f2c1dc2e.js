(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[189],{2833:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/dashboard",function(){return t(7639)}])},7639:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var l=t(5893),r=t(7294),a=t(1163),n=t(1664),i=t.n(n),d=t(9008),c=t.n(d);function o(){let e=(0,a.useRouter)(),[s,t]=(0,r.useState)([]),[n,d]=(0,r.useState)(!0),[o,m]=(0,r.useState)(""),[x,h]=(0,r.useState)({status:"",type:"",search:""});(0,r.useEffect)(()=>{let s=localStorage.getItem("token"),t=localStorage.getItem("userRole");if(!s){e.push("/login");return}if("staff"!==t&&"admin"!==t){e.push("/dashboard");return}u(s)},[e]);let u=async e=>{try{d(!0);let s=await fetch("http://localhost:5000/api/admin/grievances",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let e=await s.json();t(e)}else{let e=await s.json();m(e.message||"Failed to fetch grievances")}}catch(e){m("An error occurred while fetching grievances")}finally{d(!1)}},g=e=>{let{name:s,value:t}=e.target;h(e=>({...e,[s]:t}))},j=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"in-progress":return"bg-blue-100 text-blue-800";case"resolved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},f=s.filter(e=>{if(x.status&&e.status!==x.status||x.type&&e.type!==x.type)return!1;if(x.search){let s=x.search.toLowerCase();return e.name&&e.name.toLowerCase().includes(s)||e.email&&e.email.toLowerCase().includes(s)||e.subject&&e.subject.toLowerCase().includes(s)||e.title&&e.title.toLowerCase().includes(s)||e.universityRollNumber&&e.universityRollNumber.toLowerCase().includes(s)}return!0});return n?(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,l.jsxs)("div",{children:[(0,l.jsx)(c(),{children:(0,l.jsx)("title",{children:"Admin Dashboard - GNDEC Grievance Redressal Portal"})}),(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,l.jsx)("div",{className:"flex justify-between items-center mb-8",children:(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"})}),o&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded mb-6",children:o}),(0,l.jsx)("div",{className:"bg-white shadow sm:rounded-lg mb-6",children:(0,l.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,l.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Filters"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,l.jsxs)("select",{id:"status",name:"status",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",value:x.status,onChange:g,children:[(0,l.jsx)("option",{value:"",children:"All"}),(0,l.jsx)("option",{value:"pending",children:"Pending"}),(0,l.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,l.jsx)("option",{value:"resolved",children:"Resolved"}),(0,l.jsx)("option",{value:"rejected",children:"Rejected"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700",children:"Type"}),(0,l.jsxs)("select",{id:"type",name:"type",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",value:x.type,onChange:g,children:[(0,l.jsx)("option",{value:"",children:"All"}),(0,l.jsx)("option",{value:"academic",children:"Academic"}),(0,l.jsx)("option",{value:"hostel",children:"Hostel"}),(0,l.jsx)("option",{value:"infrastructure",children:"Infrastructure"}),(0,l.jsx)("option",{value:"other",children:"Other"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700",children:"Search"}),(0,l.jsx)("input",{type:"text",name:"search",id:"search",className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"Search by name, email, subject...",value:x.search,onChange:g})]})]})]})}),(0,l.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-5 sm:grid-cols-4 mb-6",children:[(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Grievances"}),(0,l.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:s.length})]})}),(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending"}),(0,l.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-yellow-600",children:s.filter(e=>"pending"===e.status).length})]})}),(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"In Progress"}),(0,l.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-blue-600",children:s.filter(e=>"in-progress"===e.status).length})]})}),(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Resolved"}),(0,l.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-green-600",children:s.filter(e=>"resolved"===e.status).length})]})})]}),(0,l.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:(0,l.jsx)("ul",{className:"divide-y divide-gray-200",children:0===f.length?(0,l.jsx)("li",{className:"px-4 py-4 sm:px-6 text-center text-gray-500",children:"No grievances found matching your filters"}):f.map(e=>(0,l.jsx)("li",{children:(0,l.jsx)(i(),{href:"/grievance/".concat(e._id),className:"block hover:bg-gray-50",children:(0,l.jsxs)("div",{className:"px-4 py-4 sm:px-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-blue-600 truncate",children:e.title}),(0,l.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:[e.subject," | ",e.name," (",e.email,")"]})]}),(0,l.jsxs)("div",{className:"ml-4 flex-shrink-0 flex items-center",children:[(0,l.jsx)("p",{className:"mr-2 text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),(0,l.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(j(e.status)),children:e.status})]})]}),(0,l.jsxs)("div",{className:"mt-2 sm:flex sm:justify-between",children:[(0,l.jsxs)("div",{className:"sm:flex",children:[(0,l.jsxs)("p",{className:"flex items-center text-sm text-gray-500",children:[(0,l.jsx)("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),e.type]}),(0,l.jsxs)("p",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0 sm:ml-6",children:[(0,l.jsx)("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),e.universityRollNumber]})]}),(0,l.jsxs)("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:[(0,l.jsx)("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),e.attachments?e.attachments.length:0," attachments"]})]})]})})},e._id))})})]})})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=2833)}),_N_E=e.O()}]);